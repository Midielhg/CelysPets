<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps Test - Cely's Pets Mobile Grooming</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #FEF7ED, #FED7AA);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #92400e;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .header p {
            color: #d97706;
            font-size: 1.1rem;
        }
        .map-container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        .map {
            width: 100%;
            height: 500px;
            border-radius: 12px;
            border: 2px solid #fed7aa;
        }
        .info-panel {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border-radius: 16px;
            padding: 20px;
            border: 2px solid #FBBF24;
        }
        .route-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #FBBF24;
        }
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #dc2626;
        }
        .stat-label {
            color: #d97706;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .appointments-list {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #FBBF24;
        }
        .appointment-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            background: #FEF7ED;
            border-radius: 8px;
            border-left: 4px solid #f59e0b;
        }
        .appointment-number {
            background: #f59e0b;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }
        .appointment-details h4 {
            margin: 0;
            color: #92400e;
        }
        .appointment-details p {
            margin: 5px 0 0 0;
            color: #d97706;
            font-size: 0.9rem;
        }
        .test-button {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(245, 158, 11, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üó∫Ô∏è Google Maps Route Optimization</h1>
            <p>Testing visual route display for Cely's Pets Mobile Grooming</p>
        </div>

        <div class="map-container">
            <h3 style="color: #92400e; margin-bottom: 15px;">üìç Optimized Route Map</h3>
            <div id="map" class="map"></div>
        </div>

        <div class="info-panel">
            <h3 style="color: #92400e; margin-bottom: 15px;">üìä Route Information</h3>
            
            <div class="route-stats">
                <div class="stat-card">
                    <div class="stat-value">4</div>
                    <div class="stat-label">Total Stops</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">45.6</div>
                    <div class="stat-label">Miles</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">3.2</div>
                    <div class="stat-label">Hours</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$12.40</div>
                    <div class="stat-label">Fuel Cost</div>
                </div>
            </div>

            <div class="appointments-list">
                <h4 style="color: #92400e; margin-bottom: 15px;">üìã Today's Schedule</h4>
                
                <div class="appointment-item">
                    <div class="appointment-number">üè†</div>
                    <div class="appointment-details">
                        <h4>Starting Location</h4>
                        <p>8401 Coral Way, Miami, FL 33155</p>
                    </div>
                </div>

                <div class="appointment-item">
                    <div class="appointment-number">1</div>
                    <div class="appointment-details">
                        <h4>9:00 AM - Bella (Golden Retriever)</h4>
                        <p>üìç 100 Lincoln Rd, Miami Beach, FL 33139</p>
                        <p>üêï Full Grooming Package</p>
                    </div>
                </div>

                <div class="appointment-item">
                    <div class="appointment-number">2</div>
                    <div class="appointment-details">
                        <h4>11:00 AM - Max (Poodle)</h4>
                        <p>üìç 1900 N Bayshore Dr, Miami, FL 33132</p>
                        <p>üê© Trim & Bath</p>
                    </div>
                </div>

                <div class="appointment-item">
                    <div class="appointment-number">3</div>
                    <div class="appointment-details">
                        <h4>1:00 PM - Luna (Persian Cat)</h4>
                        <p>üìç 19501 Biscayne Blvd, Aventura, FL 33180</p>
                        <p>üê± Cat Grooming Special</p>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="test-button" onclick="initializeRoute()">üîÑ Refresh Route</button>
                <button class="test-button" onclick="openInGoogleMaps()">üì± Open in Google Maps</button>
                <button class="test-button" onclick="exportRoute()">üíæ Export Route</button>
            </div>
        </div>
    </div>

    <script>
        let map;
        let directionsService;
        let directionsRenderer;

        // Sample route data
        const routeData = {
            startLocation: "8401 Coral Way, Miami, FL 33155",
            appointments: [
                {
                    address: "100 Lincoln Rd, Miami Beach, FL 33139",
                    client: "Bella",
                    time: "9:00 AM",
                    service: "Full Grooming Package"
                },
                {
                    address: "1900 N Bayshore Dr, Miami, FL 33132", 
                    client: "Max",
                    time: "11:00 AM",
                    service: "Trim & Bath"
                },
                {
                    address: "19501 Biscayne Blvd, Aventura, FL 33180",
                    client: "Luna", 
                    time: "1:00 PM",
                    service: "Cat Grooming Special"
                }
            ]
        };

        function initMap() {
            // Initialize map
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 11,
                center: { lat: 25.7617, lng: -80.1918 }, // Miami center
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                styles: [
                    {
                        featureType: 'poi',
                        elementType: 'labels',
                        stylers: [{ visibility: 'off' }]
                    }
                ]
            });

            directionsService = new google.maps.DirectionsService();
            directionsRenderer = new google.maps.DirectionsRenderer({
                draggable: false,
                polylineOptions: {
                    strokeColor: '#f59e0b',
                    strokeWeight: 4,
                    strokeOpacity: 0.8
                }
            });

            directionsRenderer.setMap(map);
            initializeRoute();
        }

        function initializeRoute() {
            if (!directionsService || !directionsRenderer) return;

            // Create waypoints
            const waypoints = routeData.appointments.slice(0, -1).map(appointment => ({
                location: appointment.address,
                stopover: true
            }));

            const destination = routeData.appointments[routeData.appointments.length - 1].address;

            // Calculate route
            directionsService.route({
                origin: routeData.startLocation,
                destination: destination,
                waypoints: waypoints,
                optimizeWaypoints: false,
                travelMode: google.maps.TravelMode.DRIVING,
                unitSystem: google.maps.UnitSystem.IMPERIAL
            }, (result, status) => {
                if (status === 'OK') {
                    directionsRenderer.setDirections(result);
                    addCustomMarkers();
                } else {
                    console.error('Directions request failed:', status);
                }
            });
        }

        function addCustomMarkers() {
            // Add start marker
            new google.maps.Marker({
                position: { lat: 25.7448, lng: -80.3889 }, // Approximate Coral Way location
                map: map,
                title: 'Starting Location',
                icon: {
                    url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                        <svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="20" cy="20" r="18" fill="#10b981" stroke="#059669" stroke-width="2"/>
                            <text x="20" y="26" text-anchor="middle" fill="white" font-size="16" font-weight="bold">üè†</text>
                        </svg>
                    `),
                    scaledSize: new google.maps.Size(40, 40),
                    anchor: new google.maps.Point(20, 20)
                }
            });

            // Add appointment markers
            const approximateLocations = [
                { lat: 25.7907, lng: -80.1300 }, // Miami Beach
                { lat: 25.7889, lng: -80.1861 }, // Bayshore Dr
                { lat: 25.9571, lng: -80.1436 }  // Aventura
            ];

            routeData.appointments.forEach((appointment, index) => {
                new google.maps.Marker({
                    position: approximateLocations[index],
                    map: map,
                    title: `${appointment.time} - ${appointment.client}`,
                    icon: {
                        url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                            <svg width="36" height="36" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="18" cy="18" r="16" fill="#f43f5e" stroke="#e11d48" stroke-width="2"/>
                                <text x="18" y="23" text-anchor="middle" fill="white" font-size="14" font-weight="bold">${index + 1}</text>
                            </svg>
                        `),
                        scaledSize: new google.maps.Size(36, 36),
                        anchor: new google.maps.Point(18, 18)
                    }
                });
            });
        }

        function openInGoogleMaps() {
            const waypoints = routeData.appointments.map(apt => 
                encodeURIComponent(apt.address)
            ).join('/');
            
            const googleMapsUrl = `https://www.google.com/maps/dir/${encodeURIComponent(routeData.startLocation)}/${waypoints}`;
            window.open(googleMapsUrl, '_blank');
        }

        function exportRoute() {
            const exportData = {
                date: new Date().toISOString().split('T')[0],
                startLocation: routeData.startLocation,
                appointments: routeData.appointments,
                totalStops: routeData.appointments.length,
                estimatedDistance: 45.6,
                estimatedDuration: 3.2,
                estimatedFuelCost: 12.40,
                generatedAt: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cely-pets-route-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Route exported successfully! üìã');
        }

        // Initialize map when page loads
        window.onload = function() {
            console.log('üó∫Ô∏è Google Maps Test Page Loaded');
            console.log('üìç API Key configured:', 'AIzaSyAKlC3v4GgU1jRhFdungYa38hbDHm0qQx0'.substring(0, 20) + '...');
        };
    </script>

    <!-- Google Maps JavaScript API -->
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAKlC3v4GgU1jRhFdungYa38hbDHm0qQx0&libraries=geometry,places&callback=initMap">
    </script>
</body>
</html>
